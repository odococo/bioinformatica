import json

import pandas as pd

from bioinformatica.data_prediction import t_wilcoxon


def test_wilcoxon():
    json_file="""[{"model": "MLP", "run_type": "train", "holdout": 0, "loss": 0.0010388237847510676, "acc": 0.9998748898506165, "auroc": 0.9998754262924194, "auprc": 0.999607264995575}, {"model": "MLP", "run_type": "test", "holdout": 0, "loss": 2.273866242170334, "acc": 0.8180862665176392, "auroc": 0.5075517892837524, "auprc": 0.11840708553791046}, {"model": "FFNN", "run_type": "train", "holdout": 0, "loss": 0.01019920933402036, "acc": 0.9965218305587769, "auroc": 0.9993396997451782, "auprc": 0.9977951049804688}, {"model": "FFNN", "run_type": "test", "holdout": 0, "loss": 2.5988604187965394, "acc": 0.8192873597145081, "auroc": 0.4977455735206604, "auprc": 0.1136908084154129}, {"model": "CNN_1", "run_type": "train", "holdout": 0, "loss": 0.10403256874364603, "acc": 0.958899974822998, "auroc": 0.9804827570915222, "auprc": 0.8997913599014282}, {"model": "CNN_1", "run_type": "test", "holdout": 0, "loss": 0.7303875654935836, "acc": 0.8159843683242798, "auroc": 0.5009350180625916, "auprc": 0.11485575884580612}, {"model": "MLP", "run_type": "train", "holdout": 1, "loss": 0.025058362495960426, "acc": 0.991917610168457, "auroc": 0.9989873170852661, "auprc": 0.9928281307220459}, {"model": "MLP", "run_type": "test", "holdout": 1, "loss": 2.589718282222748, "acc": 0.7933640480041504, "auroc": 0.5042703747749329, "auprc": 0.11626752465963364}, {"model": "FFNN", "run_type": "train", "holdout": 1, "loss": 0.03517671112469363, "acc": 0.9878389239311218, "auroc": 0.9972137808799744, "auprc": 0.9812598824501038}, {"model": "FFNN", "run_type": "test", "holdout": 1, "loss": 3.0308573603630067, "acc": 0.7955159544944763, "auroc": 0.5030602216720581, "auprc": 0.11672329902648926}, {"model": "CNN_1", "run_type": "train", "holdout": 1, "loss": 0.12551259153034103, "acc": 0.950567364692688, "auroc": 0.9716228246688843, "auprc": 0.8602519631385803}, {"model": "CNN_1", "run_type": "test", "holdout": 1, "loss": 0.6034699380397797, "acc": 0.8463616967201233, "auroc": 0.503119945526123, "auprc": 0.11953102052211761}, {"model": "MLP", "run_type": "train", "holdout": 2, "loss": 0.16693810407913917, "acc": 0.9186382293701172, "auroc": 0.9519988298416138, "auprc": 0.7153921723365784}, {"model": "MLP", "run_type": "test", "holdout": 2, "loss": 1.38182590007782, "acc": 0.8152337074279785, "auroc": 0.4941226840019226, "auprc": 0.1146460697054863}, {"model": "FFNN", "run_type": "train", "holdout": 2, "loss": 0.14347377598141375, "acc": 0.9273837208747864, "auroc": 0.9618804454803467, "auprc": 0.774202823638916}, {"model": "FFNN", "run_type": "test", "holdout": 2, "loss": 2.6986600041389464, "acc": 0.8297467827796936, "auroc": 0.4932266175746918, "auprc": 0.11171119660139084}, {"model": "CNN_1", "run_type": "train", "holdout": 2, "loss": 0.16129117849182562, "acc": 0.9370800852775574, "auroc": 0.9506946802139282, "auprc": 0.7854023575782776}, {"model": "CNN_1", "run_type": "test", "holdout": 2, "loss": 0.6019708305597306, "acc": 0.8420078158378601, "auroc": 0.49517109990119934, "auprc": 0.11495301127433777}, {"model": "MLP", "run_type": "train", "holdout": 3, "loss": 0.2418608376923286, "acc": 0.896180272102356, "auroc": 0.8724892735481262, "auprc": 0.4797278642654419}, {"model": "MLP", "run_type": "test", "holdout": 3, "loss": 1.0407809257507323, "acc": 0.871234118938446, "auroc": 0.501768171787262, "auprc": 0.11667702347040176}, {"model": "FFNN", "run_type": "train", "holdout": 3, "loss": 0.17585249491195246, "acc": 0.9070902466773987, "auroc": 0.9360558986663818, "auprc": 0.6311833262443542}, {"model": "FFNN", "run_type": "test", "holdout": 3, "loss": 2.400297749042511, "acc": 0.8637773990631104, "auroc": 0.5053181648254395, "auprc": 0.11812087893486023}, {"model": "CNN_1", "run_type": "train", "holdout": 3, "loss": 0.26259857617390503, "acc": 0.9045253992080688, "auroc": 0.8300288319587708, "auprc": 0.49783894419670105}, {"model": "CNN_1", "run_type": "test", "holdout": 3, "loss": 0.5159085839986801, "acc": 0.8625763058662415, "auroc": 0.5084909200668335, "auprc": 0.11602817475795746}, {"model": "MLP", "run_type": "train", "holdout": 4, "loss": 0.2602501786359802, "acc": 0.8898119330406189, "auroc": 0.8440986275672913, "auprc": 0.39565253257751465}, {"model": "MLP", "run_type": "test", "holdout": 4, "loss": 0.9972584307193756, "acc": 0.879091203212738, "auroc": 0.4959682524204254, "auprc": 0.1172136515378952}, {"model": "FFNN", "run_type": "train", "holdout": 4, "loss": 0.20334799086310637, "acc": 0.8927521109580994, "auroc": 0.9125803709030151, "auprc": 0.5114268064498901}, {"model": "FFNN", "run_type": "test", "holdout": 4, "loss": 2.479385268688202, "acc": 0.8777900338172913, "auroc": 0.4919617474079132, "auprc": 0.1125568374991417}, {"model": "CNN_1", "run_type": "train", "holdout": 4, "loss": 0.3123882005912464, "acc": 0.8928146958351135, "auroc": 0.6872448325157166, "auprc": 0.2788505256175995}, {"model": "CNN_1", "run_type": "test", "holdout": 4, "loss": 0.444542695581913, "acc": 0.879441499710083, "auroc": 0.4918953776359558, "auprc": 0.11384429037570953}, {"model": "MLP", "run_type": "train", "holdout": 5, "loss": 0.2369917126068032, "acc": 0.8922266364097595, "auroc": 0.8774167895317078, "auprc": 0.4552256762981415}]"""
    results = json.loads(json_file)

    df = pd.DataFrame(results)

    models = df[
        (df.run_type == "test")
    ]
    t_wilcoxon(models[models.model == 'MLP'], models[models.model == 'FFNN'])
